<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tarot Reading üîÆ</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #000;
      font-family: "Segoe UI", sans-serif;
    }

    #backBtn {
      position: fixed;
      top: 20px;
      left: 20px;
      padding: 10px 18px;
      background: rgba(255, 255, 255, 0.15);
      border: 1px solid #fff;
      border-radius: 8px;
      color: #fff;
      cursor: pointer;
      transition: 0.3s;
      z-index: 10;
    }
    #backBtn:hover { background: rgba(255, 255, 255, 0.3); }

    #title {
      position: fixed;
      top: 25px;
      left: 50%;
      transform: translateX(-50%);
      color: #fff8e1;
      font-size: 28px;
      text-shadow: 0 0 10px #d6b0ff;
      letter-spacing: 1px;
      z-index: 10;
    }

    /* ‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢ */
    .fortune {
      position: fixed;
      width: 100%;
      text-align: center;
      font-size: 20px;
      color: #ffe8ff;
      text-shadow: 0 0 10px #d6b0ff;
      line-height: 1.6em;
      opacity: 0;
      transition: opacity 1s ease;
      display: none;
      z-index: 5;
      bottom: 120px;
    }

    /* ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ï‡πâ‡πÑ‡∏û‡πà‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÉ‡∏ö */
    #fortune1 { left: 20%; transform: translateX(-50%); }
    #fortune2 { left: 50%; transform: translateX(-50%); }
    #fortune3 { left: 80%; transform: translateX(-50%); }
  </style>

  <!-- Three.js -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
</head>
<body>
  <div id="backBtn" onclick="window.location.href='./Tarot.html'">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</div>
  <div id="title">‚ú® ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏û‡πà‡∏î‡∏µ‡πÜ ‡∏ô‡πâ‡∏≤ ‚ú®</div>

  <!-- üÉè ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏û‡πà -->
  <div id="fortune1" class="fortune">üí´ ‡πÑ‡∏û‡πà‡πÉ‡∏ö‡∏ó‡∏µ‡πà 1 ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏ß‡πà‡∏≤...‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏£‡∏á‡∏™‡∏µ‡∏ü‡∏±‡∏ô‡∏ö‡πà‡∏≠‡∏¢‡πÜ 3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ï‡πà‡∏≠ 1 ‡∏≠‡∏±‡∏ô <br>‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡∏•‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏ô‡πâ‡∏≥‡∏Ñ‡∏•‡∏≠‡∏á‡πÉ‡∏ô‡πÉ‡∏à‡∏Å‡∏•‡∏≤‡∏á‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏Ç‡∏≤‡∏î</div>
  <div id="fortune2" class="fortune">üí´ ‡πÑ‡∏û‡πà‡πÉ‡∏ö‡∏ó‡∏µ‡πà 2 ‡∏ß‡πà‡∏≤‡πÑ‡∏ß‡πâ... ‡∏ñ‡πâ‡∏≤‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏£‡πâ‡∏≠‡∏ô‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡πÉ‡∏™‡πà‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏´‡∏ô‡∏≤‡∏ß ‡∏ñ‡πâ‡∏≤‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÄ‡∏¢‡πá‡∏ô‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á <br>‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏´‡πá‡∏ô‡∏û‡∏±‡∏î‡∏•‡∏°‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏´‡∏°‡∏∏‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏≠‡∏≤‡∏°‡∏∑‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÅ‡∏´‡∏¢‡πà ‡∏°‡∏¥‡∏â‡∏∞‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏à‡∏∞‡∏≠‡∏≠‡∏Å‡πÑ‡∏î‡πâ </div>
  <div id="fortune3" class="fortune">üí´ ‡πÑ‡∏û‡πà‡πÉ‡∏ö‡∏ó‡∏µ‡πà 3 ‡∏î‡∏≤‡∏ß‡∏û‡∏•‡∏π‡πÇ‡∏ï‡∏≠‡∏¢‡∏π‡πà‡∏´‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î‡∏ï‡∏∑‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Ñ‡∏ß‡∏£‡πÅ‡∏Å‡πâ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏î‡πâ‡∏ß‡∏¢ <br>‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏î‡∏Ç‡∏µ‡πâ‡πÄ‡∏Å‡∏µ‡∏¢‡∏à ‡πÅ‡∏•‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏õ‡∏£‡∏á‡∏ü‡∏±‡∏ô‡πÅ‡∏Å‡πâ‡∏õ‡∏≤‡∏Å‡πÄ‡∏´‡∏°‡πá‡∏ô </div>

  <script>
    const scene = new THREE.Scene();

    // ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á
    const textureLoader = new THREE.TextureLoader();
    textureLoader.load("./bg.png", tex => scene.background = tex);

    //‡∏Å‡∏•‡πâ‡∏≠‡∏á
    const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 2000);
    camera.position.set(0, 200, 600);
    camera.lookAt(0, 100, 0);

    //Renderer
    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    //Controls
    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.enableZoom = true;
    controls.enableRotate = true;
    controls.minDistance = 300;
    controls.maxDistance = 1000;
    controls.target.set(0, 100, 0);

    //‡πÅ‡∏™‡∏á
    const ambient = new THREE.AmbientLight(0xffffff, 0.8);
    const spot = new THREE.SpotLight(0xffeecc, 1.3);
    spot.position.set(200, 400, 300);
    scene.add(ambient, spot);

    //‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏û‡πà
    const loader = new THREE.GLTFLoader();
    const cards = [];
    const cardFiles = ["./Card01-1.glb", "./Card02-2.glb", "./Card03-1.glb"];
    const fortunes = [
      document.getElementById("fortune1"),
      document.getElementById("fortune2"),
      document.getElementById("fortune3")
    ];

    cardFiles.forEach((file, i) => {
      loader.load(file,
        (gltf) => {
          const card = gltf.scene;
          card.scale.set(80, 80, 80);
          card.position.set((i - 1) * 220, 50, 0); // ‡∏ã‡πâ‡∏≤‡∏¢-‡∏Å‡∏•‡∏≤‡∏á-‡∏Ç‡∏ß‡∏≤
          card.userData.index = i + 1;

          // ‚úÖ ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Ñ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏ä‡∏¥‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•
          card.traverse(obj => { if (obj.isMesh) obj.userData.parentIndex = i + 1; });

          scene.add(card);
          cards.push(card);
          console.log("‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏û‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:", file);
        },
        (xhr) => console.log(`üì¶ ‡πÇ‡∏´‡∏•‡∏î ${file} ${(xhr.loaded / xhr.total * 100).toFixed(1)}%`),
        (error) => console.error("‚ùå ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:", file, error)
      );
    });

    // ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÑ‡∏û‡πà
    const raycaster = new THREE.Raycaster();
    const mouse = new THREE.Vector2();
    window.addEventListener("click", (event) => {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
      raycaster.setFromCamera(mouse, camera);

      // ‡∏£‡∏ß‡∏° children ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏´‡πâ raycaster ‡∏ï‡∏£‡∏ß‡∏à
      const clickable = [];
      cards.forEach(card => card.traverse(obj => { if (obj.isMesh) clickable.push(obj); }));

      const intersects = raycaster.intersectObjects(clickable, true);
      console.log("üß≠ ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏Ñ‡∏•‡∏¥‡∏Å", intersects.length, "‡∏Ñ‡∏£‡∏±‡πâ‡∏á");

      // ‡∏ã‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡πà‡∏≠‡∏ô
      fortunes.forEach(f => { f.style.display = "none"; f.style.opacity = 0; });

      if (intersects.length > 0) {
        const hit = intersects[0].object;
        const id = hit.userData.parentIndex;
        if (!id) return;
        console.log("üé¥ ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÇ‡∏î‡∏ô Card", id);

        const f = fortunes[id - 1];
        setTimeout(() => {
          f.style.display = "block";
          setTimeout(() => { f.style.opacity = 1; }, 100);
        }, 400);
      }
    });

    // Loop
    function animate() {
      requestAnimationFrame(animate);
      controls.update();
      renderer.render(scene, camera);
    }
    animate();

    // Resize
    window.addEventListener("resize", () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>

